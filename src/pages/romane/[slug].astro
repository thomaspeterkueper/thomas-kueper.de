---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const romane = await getCollection('romane');
  return romane.map((r) => ({
    params: { slug: r.slug },
    props: { roman: r },
  }));
}

const { roman } = Astro.props;
const { Content } = await roman.render();
---

<BaseLayout title={`${roman.data.title} — Roman von Thomas Peter Küper`} description={roman.data.description ?? ''}>
  <style>
    .book-page { max-width: 950px; margin: 0 auto; padding: 6rem 2rem; color: #1a1a1a; font-family: 'Lora', serif; line-height: 1.9; }
    .hero-split { display: grid; grid-template-columns: 320px 1fr; gap: 5rem; align-items: start; margin-bottom: 5rem; }
    .cover-sticky { position: sticky; top: 120px; }
    .book-cover { width: 100%; height: auto; border-radius: 2px; box-shadow: 0 30px 60px rgba(0,0,0,0.12); border: 1px solid #f0f0f0; }
    h1 { font-family: 'Crimson Text', serif; font-size: clamp(3rem, 7vw, 5rem); text-transform: uppercase; letter-spacing: 0.15em; margin: 0 0 0.5rem; font-weight: 300; line-height: 1; }
    .meta { font-family: 'Lato', sans-serif; text-transform: uppercase; letter-spacing: 3px; font-size: 0.75rem; color: #888; display: block; margin-bottom: 1rem; }
    .tagline { font-size: 1.2rem; color: var(--color-gold); font-style: italic; margin-bottom: 2rem; display: block; line-height: 1.4; }
    h2 { font-family: 'Crimson Text', serif; font-size: 2.4rem; margin: 4rem 0 1.5rem; border-bottom: 1px solid #eee; padding-bottom: 0.5rem; }
    .back-nav { margin-top: 6rem; text-align: center; padding-top: 3rem; border-top: 1px solid #eee; }
    .btn-archive { text-decoration: none; color: #888; font-family: 'Lato', sans-serif; font-weight: 600; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; }
    @media (max-width: 850px) {
      .hero-split { grid-template-columns: 1fr; text-align: center; }
      .cover-sticky { position: relative; top: 0; max-width: 250px; margin: 0 auto 2rem; }
    }
  </style>

  <article class="book-page">
    <div class="hero-split">
      <div class="cover-sticky">
        {roman.data.cover && <img src={roman.data.cover} alt={`Cover ${roman.data.title}`} class="book-cover" />}
      </div>

      <div>
        <span class="meta">{roman.data.genre ?? 'Roman'}</span>
        <h1>{roman.data.title}</h1>
        {roman.data.description && <span class="tagline">{roman.data.description}</span>}
      </div>
    </div>

    <div class="main-content">
      <Content />
    </div>

    <footer class="back-nav">
      <a href="/romane/" class="btn-archive">← Zurück zur Roman-Übersicht</a>
    </footer>
  </article>
</BaseLayout>
